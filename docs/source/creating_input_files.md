# Input Files
The basic input file for Pylot is a JSON object describing the simulation parameters, control inputs, and aircraft initial state. A separate JSON object is used to specify the aerodynamics of the aircraft.

## JSON Format
The basic structure of a JSON object is a set of key-value pairs, analogous to a Python dictionary. Examples can be found in the examples/ directory. The following sections describe the structure of the JSON objects used to interface with Pylot. Only one JSON object is specified per .json file. When using the JSON objects, only the simulation object is passed to Pylot. Pylot will automatically locate the aircraft object specified in the simulation object.

## Units
Pylot allows the user to specify the units for each value if they desire. For float values, this is done by making the value a list where the first element is the actual value and the second element is a string specifying the units. For example:

    "area" : [6.75, "ft^2"]

For vector inputs, such as position and velocity, the units are simply appended to the vector:

    "velocity" : [100.0, 13.0, 0.0, "ft/s"]

For array inputs, such as a density profile or chord distribution, the units are appended as another row in the array:

    "rho" : [[0.0, 1.225],
             [2000.0, 1.0066],
             [4000.0, 0.81935],
             ["m", "kg/m^3"]]

When specifying column units in files, these are also appended as another row:

    # File: density_profile.csv
    0.0, 1.225,
    2000.0, 1.0066,
    4000.0, 0.81935,
    "m", "kg/m^3"

The following measurements can be defined with the accompanying units:

| Measurement                   | Acceptable Units                  |
| ----------------------------- | --------------------------------- |
| Position/displacement/length: | "ft", "m", "in", "cm"             |
| Area:                         | "ft^2", "m^2"                     |
| Velocity:                     | "ft/s", "m/s", "mph", "kph", "kn" |
| Angular deflection/position:  | "deg", "rad"                      |
| Angular rate:                 | "deg/s", "rad/s"                  |
| Density:                      | "slug/ft^3", "kg/m^3"             |
| Weight/Force:                 | "lbf", "N"                        |
| Moment:                       | "ft lbf", "Nm"                    |
| Mass Moment of Inertia        | "slug ft^2", "kg m^2"             |
| Angular Momentum              | "slug ft^2/s", "kg m^2/s"         |

*Note the carat is required in units containing powers. Otherwise, Pylot will not recognize the unit specification.*

Except for angular measurements, the first unit listed is the default for "English" units. The second is the default for "SI". For angular measurements of state and control deflections, as well as airframe geometry, the default is always degrees. For airfoil parameters, measurements may only be expressed in radians. When specifying units in an array and one of the measurements is dimensionless (e.g. span fraction), "-" should be used. Any results generated by MachUpX will be output in the default unit for the given system, regardless of how units were specified for the inputs.

## Simulation Object
The following are keys which can be specified in the simulation JSON object. NOTE: all keys not marked as optional are required. Key names typed in all capitals between carats (e.g. <KEY_VALUE>) are to be deterimined by the user.

>**"tag" : string, optional**
>>A note on the specific input. Does not affect execution.
>>
>**"simulation" : dict**
>>Defines simulation parameters.
>>
>>**"real_time" : boolean, optional**
>>>Whether the physics should be solved in real time. If true, the physics will be solved at as high of a rate as the CPU can handle. Defaults to false.
>>
>>**"timestep" : float, optional**
>>>Timestep used in the physics if not set to solve in real time. Defaults to 0.05 s.
>>
>>**"start_time" : float, optional**
>>>Time index at which to start the simulation. Defaults to 0.0 s.
>>
>>**"final_time" : float, optional**
>>>Time index at which to stop the simulation. Defaults to infinity, meaning the simulator will run indefinitely.
>>
>>**"enable_graphics" : boolean, optional**
>>>Whether to render the aircraft in a simulated environment. Defaults to false.
>>
>>**"target_framerate" : int, optional**
>>>Desired number of graphics updates per second. The graphics will update no faster than this. Defaults to 30.
>
>**"units" : string, optional**
>>Specifies the unit system to be used for inputs and outputs. Can be "SI" or "English". Any units not explicitly defined for each value in the input objects will be assumed to be the default unit for that measurement in the system specified here. Defaults to "English".
>
>**"atmosphere" : dict, optional**
>Specifies the state of the atmosphere the aircraft exists in.
>
>>**"density" : float or string, optional**
>>>If a float, the atmospheric density is assumed constant at this value. The following standard profiles can also be specified:
>>>
>>>>"standard"
>>>
>>>Defaults to density at sea-level.
>>>
>**"aircraft" : dict**
>>Describes the aircraft being simulated.
>>
>>**"name" : string**
>>>Name of the aircraft.
>>
>>**"file" : string**
>>>Path to file containing the JSON object describing the aircraft.
>>
>>**"trim" : dict, optional**
>>>If this key is specified, the simulator will start the aircraft trimmed in a climbing turn described by the following keys. If this key is not specified, "initial_state" must be alternately specified.
>>>
>>>**"velocity" : float**
>>>>Initial airspeed.
>>>
>>>**"position" : vector**
>>>>Initial position in Earth-fixed coordinates.
>>>
>>>**"climb_angle" : float, optional**
>>>>Initial climb angle in degrees. Defaults to 0.0.
>>>
>>>**"bank_angle" : float, optional**
>>>>Initial bank angle in degrees. Defaults to 0.0.
>>>
>>>**"heading" : float, optional**
>>>>Initial heading in degrees. Defaults to 0.0.
>>>
>>>**"verbose" : boolean, optional**
>>>>Whether to output intermediate guesses at each step of the iterative trim algorithm. Helps inform the user as to the progress/convergence of trim. Defaults to false.
>>
>>**"initial_state" : dict, optional**
>>>If this key is specified, the simulator will start the aircraft in the given state. No trimming will be performed. If this key is not specified, "trim" must be alternately specified.
>>>
>>>**"position" : vector**
>>>>Position of the origin of the aircraft's body-fixed coordinate system in earth-fixed coordinates.
>>>
>>>**"velocity" : vector**
>>>>Body-fixed velocity components.
>>>
>>>**"orientation" : vector, optional**
>>>>Orientation of the aircraft, going from earth-fixed frame to body-fixed frame. If this is a 3-element vector it is assumed the ZYX Euler angle formulation is used (i.e. [psi, theta, phi]). If this is a 4-element vector it is assumed the quaternion formulation is used where the first element is the scalar (i.e. [e0, ex, ey, ez]). Defaults to [1.0, 0.0, 0.0, 0.0], which will align the body- fixed frame with the earth-fixed frame.
>>>
>>>**"angular_rates" : vector, optional**
>>>>Angular rates of the aircraft in body-fixed coordinates, corresponding to p, q, and r. Defaults to [0.0, 0.0, 0.0].
>>>
>>>**"control_state" : dict, optional**
>>>>Describes the control settings. The number and names of controls are arbitrary and may be specified by the user.
>>>
>>>>**"<CONTROL_NAME>" : float, optional**
>>>>>Control setting. Defaults to neutral setting of 0.5.
>>**"state_output" : string, optional**
>>>If specified, the simulator will write the 13 element state vector of the aircraft to this file at each time step. THIS WILL OVERWRITE ANY EXISTING FILE OF THE SAME NAME. Defaults to no output.
>>**"control_input" : string**
>>>Specifies how the aircraft is to be controlled. Real-time, direct user control is chosen by specifying "joystick" or "keyboard". The aircraft can also be controlled using a pre-defined control sequence. This sequence should be stored in a text file, the name of which is given here. The controls should be formatted in columns where the first column is the time index and each successive column corresponds the control settings. The order of the columns is determined by the "input_index" key in the "controls" object within the "aircraft" object. For example, if the aircraft has a control called "flaps" which was given the "input_index" of 1, then the second column in the text file given here will be used as the "flaps" control setting.

## Aircraft Object
Describes an aircraft. The aerodynamics of the aircraft may be determined in one of two ways. The first is using a model of linearized aerodynamic coefficients, as described by Phillips (Mechanics of Flight, 2nd ed., pp. 1067-8). The second is using MachUpX, a Python implementation of general numerical lifting-line theory. The method is specified using the "aero_model" key. If the linearized model is to be used, then the "coefficients" key must be specified. Else, "wings" must be specified. All other keys are the same between the two methods. Examples of both can be found in the examples/ directory.

>**"units" : string, optional**
>>Specifies the unit system to be used when importing the aircraft object. Can be "SI" or "English". Any units not explicitly defined for each value in the input objects will be assumed to be the default unit for that measurement in the system specified here. Defaults to "English".
>
>**"CG" : vector, optional**
>>Location of the aircraft's center of gravity in body-fixed coordinates. Defaults to [0.0, 0.0, 0.0], as the origin of the body-fixed coordinate system is typically the aircraft's center of gravity.
>
>**"weight" : float**
>>Weight of the aircraft.
>
>**"inertia" : dict"**
>>Describes the mass moments of inertia of the aircraft.
>>
>>**"Ixx" : float**
>>>Mass moment of inertia about the body x-axis.
>>
>>**"Iyy" : float**
>>>Mass moment of inertia about the body y-axis.
>>
>>**"Izz" : float**
>>>Mass moment of inertia about the body z-axis.
>>
>>**"Ixy" : float**
>>>Product of inertia about the body x and y-axes.
>>
>>**"Ixz" : float**
>>>Product of inertia about the body x and z-axes.
>>
>>**"Iyz" : float**
>>>Product of inertia about the body y and z-axes.
>
>**"angular_momentum" : vector, optional**
>>Angular momentum vector of aircraft conponents relative to the body-fixed frame. This is typically generated by spinning powerplant components. Defaults to [0.0, 0.0, 0.0].
>
>**"reference" : dict, optional**
>>Specifies the reference lengths and areas used to redimensionalize coefficients. If the aircraft is to be modelled using MachUpX, all or none of these may be specified. If the aircraft is to be modelled using a set of linearized coefficients, at least two of these must be given, from which the third will be calculated, if not provided. It is assumed area = longitudinal_length * lateral_length.
>
>>**"area" : float**
>>>The reference area.
>>
>>**"longitudinal_length" : float**
>>>Longitudinal reference length.
>>
>>**"lateral_length" : float**
>>>Lateral reference length.
>
>**"control_inputs" : dict, optional**
>>Defines the control inputs of the aircraft. The number and names of inputs are arbitrary and may be specified by the user. A simple aircraft, such as a chuck glider may have no controls, whereas a more complex aircraft may have controls for aileron, elevator, rudder, and multiple flaps. Defining the controls here can be thought of as deciding which control knobs/switches/sticks you want to make available to the pilot. These control inputs assume settings between 0.0 and 1.0, with 0.5 being the neutral setting.
>
>>**"<CONTROL_NAME>" : dict**
>>
>>>**"is_symmetric" : bool**
>>>>Specifies whether this control causes symmetric or asymmetric control surface deflections (e.g. for a typical aircraft, the elevator control causes symmetric deflections whereas the aileron causes asymmetric deflections).
>>>**"input_index" : int**
>>>>Specifies the joystick/keyboard axis or column index tied to this control. For joystick/keyboard control, the following indices correspond to the following input axes:
>>>>
>>>>| Input Index   | Joystick/Keyboard Axis    |
>>>>| 0             | roll                      |
>>>>| 1             | pitch                     |
>>>>| 2             | yaw                       |
>>>>| 3             | throttle                  |
>>>>
>>>>For most aircraft, each joystick/keyboard axis will typically correspond to their traditional control surfaces. However, other configurations may be desired. For example, in an aircraft with no ailerons, it may be desirable to tie the "rudder" control to the joystick roll axis, to simplify user input. For more information on the joystick and keyboard axes, see [User Interface](user_interface).
>
>**"engines" : dict, optional**
>>Specifies the propulsion system(s) of the aircraft. The aircraft may have any number of engines. If more than one is desired, the following set of keys is simply repeated.
>>
>>**"<ENGINE_NAME>" : dict**
>>>Describes a single engine. The thrust produced is assumed to be modelled by the function
>>>
>>>>T = t\*(d/d0)^a\*(T0+T1\*V+T2\*V^2)
>>>
>>>where T is the thrust, t is the control setting, d is the air density at the current altitude, d0 is the air density at sea level, V is the airspeed, and a, T0, T1, and T2 are engine-specific parameters.
>>>
>>>**"offset" : vector, optional**
>>>>Location of the engine in body-fixed coordinates. Defaults to [0.0, 0.0, 0.0].
>>>
>>>**"direction" : vector, optional**
>>>>Direction of the thrust vector produced in body-fixed coordinates. Defaults to [-1.0, 0.0, 0.0].
>>>
>>>**"T0"
>
>**"airfoils" : dict**
>>Defines the airfoil section parameters for all airfoils used on the aircraft. Any number of airfoils can be defined for the aircraft. MachUp pulls from these airfoil definitions as needed, depending on which airfoils are specified for the wings. If no airfoils are listed here MachUp will automatically generate a default airfoil and use it on all lifting surfaces. The default values listed above are for a flat plate as predicted by thin airfoil theory. Do not expect these to give you accurate results. A dictionary defining an airfoil has the following structure:
>
>>**"<AIRFOIL_NAME>" : dict**
>>
>>>**"type" : string**
>>>>The type of information describing the airfoil. Can be "linear" and the following keys must be defined, either here or in a JSON object pointed to by "path". UNITS MAY NOT BE SPECIFIED BY THE USER FOR ANY AIRFOIL PARAMETERS. THESE VALUES MUST BE SPECIFIED IN THE UNITS GIVEN HERE.
>>>
>>>**"aL0" : float, optional**
>>>>The zero-lift angle of attack in radians. Defaults to 0.0.
>>>
>>>**"CLa" : float, optional**
>>>>The lift slope in radians^-1. Defaults to 2pi
>>>
>>>**"CmL0" : float, optional**
>>>>The zero-lift moment coefficient. Defaults to 0.0.
>>>
>>>**"Cma" : float, optional**
>>>>The moment slope in radians^-1. Defaults to 0.0.
>>>
>>>**"CD0" : float, optional**
>>>>Constant coefficient in the quadratic fit of the CD/CL curve. Defaults to 0.0.
>>>
>>>**"CD1" : float, optional**
>>>>Linear coefficient in the quadratic fit of the CD/CL curve. Defaults to 0.0.
>>>
>>>**"CD2" : float, optional**
>>>>Quadratic coefficient in the quadratic fir of the CD/CL curve. Defaults to 0.0.
>>>
>>>**"CL_max" : float, optional**
>>>>Maximum lift coefficient. Defaults to infinity.
>>>
>>>**"geometry" : dict, optional**
>>>>Describes the geometry of the airfoil.
>>>>
>>>>**"outline_points" : str or array, optional**
>>>>>Path to a file containing airfoil outline points or array of outline points. The first column contains x-coordinates and the second column contains y-coordinates, where x originates at the leading edge and points back along the chord line and y points up. If a file, it should be comma-delimited. The trailing edge should be sealed. The geometry specified here will only be used in generating 3D models and will not affect the aerodynamics. Cannot be specified along with "outline_points".
>>>>
>>>>**"NACA" : str, optional**
>>>>>NACA designation for the airfoil. If given, MachUpX will automatically generate outline points using the NACA equations. Can only be NACA 4-digit series. Cannot be specified along with "outline_points". Will not affect aerodynamics.
>>>
>>>**"path" : string, optional**
>>>>Path to file containing a JSON object describing the airfoil using the above keys.
>
>**"wings" : dict**
>>Gives the lifting surfaces for the aircraft. Wings, stabilizers, fins, etc. are all treated the same in numerical lifting-line and so should be included here as wing segments. MachUp is set up so the user can define complex geometries by attaching the ends of different wing segments together (for an example, see the examples/ directory). The user can define any number of wing segments within this dict. Note that each wing segment can only have one control surface.
>
>>**"<WING_SEGMENT_NAME>" : dict**
>>
>>>**"ID" : uint**
>>>>ID tag of the wing segment, used for specifying which other wing segments are defined relative to it. MAY NOT BE 0.
>>>
>>>**"is_main" : bool**
>>>>Specifies whether this wing segment is part of the main wing (used for determining reference lengths and areas).
>>>
>>>**"side" : string**
>>>>May be "right", "left", or "both". Defines which side(s) of the aircraft the wing segment appears on. If "both", the wing segment will be mirrored across the x-z plane.
>>>
>>>**"connect_to" : dict**
>>>>Places the origin for the wing segment. This can be defined relative to the aircraft's body-fixed origin, or the root or tip of any other wing segment.
>>>>
>>>>**"ID" : uint, optional**
>>>>>ID of the wing segment this wing segment's origin is being defined relative to. If 0, this wing segment's origin will be defined relative to the aircraft's body-fixed origin. Defaults to 0.
>>>>
>>>>**"location" : string, optional**
>>>>>May be "root" or "tip". Defines whether this wing segment's origin should be defined relative to the root or tip of the other wing segment. Defaults to "tip"
>>>>
>>>>**"dx" : float, optional**
>>>>>Displacement of the origin from the selected reference point in the body-fixed x- direction. Defaults to 0.
>>>>
>>>>**"dy" : float, optional**
>>>>>Displacement of the origin from the selected reference point in the body-fixed y- direction. NOTE: If "side" is specified as "both", changing this value will shift both sides of the wing segment in the SAME direction. The effect is not mirrored. Defaults to 0.
>>>>
>>>>**"dz" : float, optional**
>>>>>Displacement of the origin from the selected reference point in the body-fixed z- direction. Defaults to 0.
>>>>
>>>>**"y_offset" : float, optional**
>>>>>Distance the origin should be shifted from the centerline (positive offset corresponds to outward). If "side" is specified as "both", this effect is mirrored. Defaults to 0.
>>>
>>>**"semispan" : float**
>>>>Length of the wing segment, discounting sweep. If "side" is specified as "both", the total span of the segment is twice this value.
>>>
>>>**"twist" : float, array, or string, optional**
<<<<<<< HEAD
>>>>Gives the GEOMETRIC twist of the wing. If specified as a float, then this is simply the mounting angle of the wing segment and the segment will have no further twist. If specified as an array, the array gives the twist as a function of span. The first column gives the span location as a fraction of the total span. This column must have values going from 0.0 to 1.0. The second column gives the twist at that span location. If specified as a string, this string must contain the path to a csv file containing the twist data formatted in columns, as with the array. For properties as a function of span, MachUp will linearly interpolate intermediate values. If a step change in distribution is needed, this can be done by specifying the span location where the step change occurs twice, once with each value:
>>>>
>>>>>**"twist" : [[0.0, 0.0], [0.5, 0.0], [0.5, 2.0], [1.0, 2.0]]**
>>>>
>>>>In the above example, the twist will be 0 degrees for the inner half of the wing and 2 degrees for the outer half of the wing. Note that this parameter also determines the mounting angle and washout of the wing segment. Defaults to 0.
=======
>>>>Gives the GEOMETRIC twist of the wing. If specified as a float, then this is simply the mounting angle of the wing segment and the segment will have no further twist. If specified as an array, the array gives the twist as a function of span. The first column gives the span location as a fraction of the total span. This column must have values going from 0.0 to 1.0. The second column gives the twist at that span location. If specified as a string, this string must contain the path to a **.csv** file containing the twist data formatted in columns, as with the array. There should be no header in this file. For properties as a function of span, MachUp will linearly interpolate intermediate values. Note that this parameter also determines the mounting angle and washout of the wing segment. Defaults to 0.
>>>>>>> v1.0.1-dev
>>>
>>>**"dihedral" : float, array, or string, optional**
>>>>Gives the dihedral of the wing segment. This is a solid-body rotation of the wing about the body x-axis. Defined the same as "twist". Defaults to 0.
>>>
>>>**"sweep" : float, array, or string, optional**
>>>>Gives the sweep angle of the wing segment. Sweeping the wing is a shear tranformation, rather than a solid-body rotation. This means the amount of sweep will not affect the distance of the wingtip from the plane of symmetry. Defined the same as "twist". Defaults to 0.
>>>
>>>**"chord" : float, array, or string, optional**
>>>>Gives the chord length of the wing segment. Defined the same as "twist". Can optionally be specified as elliptic using the following definition:
>>>
>>>>>**"chord" : ["elliptic", 1.0]**
>>>
>>>>Where the number is the root chord length. Units can be specified using:
>>>
>>>>>**"chord" : ["elliptic", 1.0, "ft"]**
>>>
>>>>Defaults to 1.0.
>>>
>>>**"ac_offset" : float, array, or string, optional**
>>>>Gives the offset of the section aerodynamic center from the quarter chord as a fraction of the chord. A positive value puts the local aerodynamic center behind the quarter chord. Defined the same as "twist". Defaults to 0.
>>>
>>>**"airfoil" : string or array, optional**
>>>>Gives the section airfoil(s) of the wing segment. Can be the name of any airfoil defined under "airfoils" in this object. If specified as an array, the array gives the airfoil as a function of span. The first column gives the span location, as with "twist", and the second column gives the name of the airfoil at that location. Can also be the path to a csv file containing the airfoil distribution formatted in columns, as with the array. Defaults to the name of the first airfoil listed under "airfoils". Cannot have units.
>>>
>>>**"grid" : dict, optional**
>>>>Describes the distribution of control points along the wing.
>>>>
>>>>**"N" : int, optional**
>>>>>Number of horseshoe vortices used to model the wing segment in the numerical lifting-line algorithm. This is the number of horseshoe vortices per semispan. Defaults to 40.
>>>>
>>>>**"distribution" : str or list, optional**
>>>>>Specifies how vortex nodes and control points are to be distributed along the wing segment. Can be "linear", "cosine_cluster", or a list of span locations. "linear" will distribute the control points and vortex nodes evenly along the span. "cosine_cluster" will implement traditional cosine clustering, where points are spaced evenly in theta causing them to cluster at the tips of each segment. If this is a list, it must be an ordered list of span locations of length 2N+1 explicitly giving the span fraction location of each vortex node and control point. Should be arranged as ```[node_0_loc, cp_0_loc, node_1_loc, cp_1_loc,..., node_N_loc, cp_N_loc, node_N+1_loc]```. Defaults to "cosine_cluster".
>>>>
>>>>**"flap_edge_cluster" : bool, optional**
>>>>>If true, control points will be clustered around the edges of control surfaces. Can only be used if "distribution" is "cosine_cluster". Defaults to true.
>>>>
>>>>**"cluster_points" : list, optional**
>>>>>If extra clustering is desired (for example at a sharp change in geometry) the user can specify a list of additional span fractions here about which control points should be clustered. Can only be used is "distribution" is "cosine_cluster". Defaults to no extra clustering.
>>>
>>>**"control_surface" : dict, optional**
>>>>Defines a control surface on the trailing edge of the wing segment. Uses Phillips' approximations for trailing-edge flaps (Mechanics of Flight, ed. 2, Ch. 1.7).
>>>
>>>>**"root_span" : float, optional**
>>>>>The span location, as a fraction of total span, where the control surface begins. Defaults to 0.0.
>>>
>>>>**"tip_span" : float, optional**
>>>>>The span location, as a fraction of total span, where the control surface ends. Defaults to 1.0.
>>>
>>>>**"chord_fraction" : float, array, or string, optional**
>>>>>The depth of the control surface, as a fraction of the local chord length. Defined the same as "twist". If an array or file is specified, however, the start and end of the data must coincide with "root_span" and "tip_span", respectively. Defaults to 0.25.
>>>
>>>>**"is_sealed" : bool, optional**
>>>>>Whether or not the flap is sealed. Affects how parasitic drag is modelled. Defaults to true.
>>>
>>>>**"control_mixing" : dict**
>>>>>Determines which control inputs move this control surface. A control surface can be affected by any number of controls.
>>>>>
>>>>>**"<CONTROL_NAME>" : float**
>>>>>>Linearly maps the control deflection to the control surface deflection. The control deflection will be multiplied by this value and then applied to the control surface.
